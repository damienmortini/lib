const a10_0x2566=['createApiAxiosInstance','project','response','../../../utilities/metric-logger','parseCommand','Completing\x20with\x20an\x20error','../../../utilities/axios','apply','serializeOverrides','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','__esModule','map','DistributedExecutionApi','../../../utilities/serializer-overrides','start','mapRespToPerfEntry','/nx-cloud/executions/complete-run-group','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','error:\x20','defineProperty','createStartRequest','done','ciExecutionId:\x20','false','createMetricRecorder','enabled','throw','note','apiAxiosInstance','../../../utilities/nx-imports','runGroup:\x20','parallel','VERBOSE_LOGGING','agentCount','stopAgentsOnFailure','dteStatus','maxParallel','ciExecutionEnv:\x20','error','message','data','then','status','value','post','recordMetric','axiosException','true','completeRunGroupWithError','__awaiter','RUNNER_FAILURE_PERF_ENTRY','NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE','../../../utilities/environment','completeRunGroup','axiosMultipleTries','exit','stringify','target'];(function(_0x33c801,_0x2566de){const _0xea0bd2=function(_0x261120){while(--_0x261120){_0x33c801['push'](_0x33c801['shift']());}};_0xea0bd2(++_0x2566de);}(a10_0x2566,0x13d));const a10_0xea0b=function(_0x33c801,_0x2566de){_0x33c801=_0x33c801-0x0;let _0xea0bd2=a10_0x2566[_0x33c801];return _0xea0bd2;};'use strict';var __awaiter=this&&this[a10_0xea0b('0x16')]||function(_0x2e0fb0,_0x5056ef,_0x128142,_0x411a1a){function _0x2827f0(_0x109753){return _0x109753 instanceof _0x128142?_0x109753:new _0x128142(function(_0x590468){_0x590468(_0x109753);});}return new(_0x128142||(_0x128142=Promise))(function(_0x4d7202,_0xc028f0){function _0x4b2908(_0x248b12){try{_0x31b8e4(_0x411a1a['next'](_0x248b12));}catch(_0x59f324){_0xc028f0(_0x59f324);}}function _0x8dc97e(_0xd19c89){try{_0x31b8e4(_0x411a1a[a10_0xea0b('0x39')](_0xd19c89));}catch(_0x1df652){_0xc028f0(_0x1df652);}}function _0x31b8e4(_0x486556){_0x486556[a10_0xea0b('0x34')]?_0x4d7202(_0x486556[a10_0xea0b('0x10')]):_0x2827f0(_0x486556[a10_0xea0b('0x10')])[a10_0xea0b('0xe')](_0x4b2908,_0x8dc97e);}_0x31b8e4((_0x411a1a=_0x411a1a[a10_0xea0b('0x26')](_0x2e0fb0,_0x5056ef||[]))['next']());});};Object[a10_0xea0b('0x32')](exports,a10_0xea0b('0x29'),{'value':!![]});exports[a10_0xea0b('0x33')]=exports[a10_0xea0b('0x2b')]=void 0x0;const axios_1=require(a10_0xea0b('0x25'));const environment_1=require(a10_0xea0b('0x19'));const metric_logger_1=require(a10_0xea0b('0x22'));const serializer_overrides_1=require(a10_0xea0b('0x2c'));const {output}=require(a10_0xea0b('0x2'));class DistributedExecutionApi{constructor(_0x14735c){this[a10_0xea0b('0x1')]=(0x0,axios_1[a10_0xea0b('0x1f')])(_0x14735c);}[a10_0xea0b('0x2d')](_0x5f3a6f){var _0x4f1dad;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x56b6c7=(0x0,metric_logger_1[a10_0xea0b('0x37')])('dteStart');let _0x128f49;if(environment_1[a10_0xea0b('0x5')]){output['note']({'title':'Starting\x20a\x20distributed\x20execution','bodyLines':[JSON[a10_0xea0b('0x1d')](_0x5f3a6f,null,0x2)]});}try{_0x128f49=yield(0x0,axios_1[a10_0xea0b('0x1b')])(()=>this[a10_0xea0b('0x1')][a10_0xea0b('0x11')]('/nx-cloud/executions/start',_0x5f3a6f));_0x56b6c7[a10_0xea0b('0x12')]((0x0,metric_logger_1[a10_0xea0b('0x2e')])(_0x128f49));}catch(_0x2b7f3b){_0x56b6c7[a10_0xea0b('0x12')](((_0x4f1dad=_0x2b7f3b===null||_0x2b7f3b===void 0x0?void 0x0:_0x2b7f3b[a10_0xea0b('0x13')])===null||_0x4f1dad===void 0x0?void 0x0:_0x4f1dad[a10_0xea0b('0x21')])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x2b7f3b[a10_0xea0b('0x13')][a10_0xea0b('0x21')]):metric_logger_1[a10_0xea0b('0x17')]);throw _0x2b7f3b;}if(!_0x128f49['data'][a10_0xea0b('0x38')]){throw new Error(a10_0xea0b('0x28'));}if(_0x128f49[a10_0xea0b('0xd')]['error']){throw new Error(_0x128f49[a10_0xea0b('0xd')][a10_0xea0b('0xb')]);}return _0x128f49[a10_0xea0b('0xd')]['id'];});}[a10_0xea0b('0xf')](_0x3b89b6){var _0x32077a;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1490cf=(0x0,metric_logger_1[a10_0xea0b('0x37')])(a10_0xea0b('0x8'));try{const _0x39141f=yield(0x0,axios_1[a10_0xea0b('0x1b')])(()=>this['apiAxiosInstance']['post']('/nx-cloud/executions/status',{'id':_0x3b89b6}));_0x1490cf['recordMetric']((0x0,metric_logger_1[a10_0xea0b('0x2e')])(_0x39141f));return _0x39141f[a10_0xea0b('0xd')];}catch(_0x439c51){_0x1490cf[a10_0xea0b('0x12')](((_0x32077a=_0x439c51===null||_0x439c51===void 0x0?void 0x0:_0x439c51[a10_0xea0b('0x13')])===null||_0x32077a===void 0x0?void 0x0:_0x32077a['response'])?(0x0,metric_logger_1['mapRespToPerfEntry'])(_0x439c51[a10_0xea0b('0x13')][a10_0xea0b('0x21')]):metric_logger_1[a10_0xea0b('0x17')]);output['error']({'title':_0x439c51[a10_0xea0b('0xc')]});process[a10_0xea0b('0x1c')](0x1);}});}[a10_0xea0b('0x15')](_0x4f45ed,_0x2d7b7e,_0x46267c,_0x59fadf,_0x460e01){var _0x502069;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x195586=(0x0,metric_logger_1['createMetricRecorder'])(a10_0xea0b('0x1a'));if(environment_1['VERBOSE_LOGGING']){output[a10_0xea0b('0x0')]({'title':a10_0xea0b('0x24'),'bodyLines':[a10_0xea0b('0x35')+_0x46267c,a10_0xea0b('0xa')+_0x59fadf,a10_0xea0b('0x3')+_0x2d7b7e,a10_0xea0b('0x31')+_0x460e01]});}try{const _0x15e892=yield(0x0,axios_1[a10_0xea0b('0x1b')])(()=>this[a10_0xea0b('0x1')][a10_0xea0b('0x11')](a10_0xea0b('0x2f'),{'branch':_0x4f45ed,'runGroup':_0x2d7b7e,'ciExecutionId':_0x46267c,'ciExecutionEnv':_0x59fadf,'criticalErrorMessage':_0x460e01}),0x3);_0x195586[a10_0xea0b('0x12')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x15e892));}catch(_0x489efc){_0x195586['recordMetric'](((_0x502069=_0x489efc===null||_0x489efc===void 0x0?void 0x0:_0x489efc[a10_0xea0b('0x13')])===null||_0x502069===void 0x0?void 0x0:_0x502069[a10_0xea0b('0x21')])?(0x0,metric_logger_1[a10_0xea0b('0x2e')])(_0x489efc[a10_0xea0b('0x13')][a10_0xea0b('0x21')]):metric_logger_1['RUNNER_FAILURE_PERF_ENTRY']);}});}}exports[a10_0xea0b('0x2b')]=DistributedExecutionApi;function createStartRequest(_0xb69a17,_0x481f1f,_0xc495fd,_0x5bd453,_0x5ab9d9,_0x5456c9,_0x3e4d85){const _0x3a5b70=_0x5ab9d9[a10_0xea0b('0x2a')](_0x3a9c4a=>{return _0x3a9c4a['map'](_0x62d6ce=>{return{'taskId':_0x62d6ce['id'],'hash':_0x62d6ce['hash'],'projectName':_0x62d6ce[a10_0xea0b('0x1e')][a10_0xea0b('0x20')],'target':_0x62d6ce[a10_0xea0b('0x1e')]['target'],'configuration':_0x62d6ce[a10_0xea0b('0x1e')]['configuration']||null,'params':(0x0,serializer_overrides_1[a10_0xea0b('0x27')])(_0x62d6ce)};});});const _0x2f1407={'command':(0x0,environment_1[a10_0xea0b('0x23')])(),'branch':_0xb69a17,'runGroup':_0x481f1f,'ciExecutionId':_0xc495fd,'ciExecutionEnv':_0x5bd453,'tasks':_0x3a5b70,'maxParallel':calculateMaxParallel(_0x5456c9),'commitSha':_0x3e4d85};if(environment_1[a10_0xea0b('0x30')]){_0x2f1407[a10_0xea0b('0x6')]=environment_1[a10_0xea0b('0x30')];}if(!environment_1[a10_0xea0b('0x18')]){_0x2f1407[a10_0xea0b('0x7')]=![];}return _0x2f1407;}exports[a10_0xea0b('0x33')]=createStartRequest;function calculateMaxParallel(_0x1893f7){if(_0x1893f7[a10_0xea0b('0x4')]===a10_0xea0b('0x36')||_0x1893f7[a10_0xea0b('0x4')]===![]){return 0x1;}else if(_0x1893f7[a10_0xea0b('0x4')]===a10_0xea0b('0x14')||_0x1893f7[a10_0xea0b('0x4')]===!![]){return Number(_0x1893f7['maxParallel']||0x3);}else if(_0x1893f7[a10_0xea0b('0x4')]===undefined){return _0x1893f7[a10_0xea0b('0x9')]?Number(_0x1893f7['maxParallel']):0x3;}else{return Number(_0x1893f7[a10_0xea0b('0x4')])||0x3;}}